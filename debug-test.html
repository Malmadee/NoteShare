<!DOCTYPE html>
<html>
<head>
    <title>Upload Debug Test</title>
    <style>
        body { font-family: Arial; margin: 20px; }
        .section { margin: 20px 0; padding: 15px; background: #f0f0f0; }
        pre { background: #000; color: #0f0; padding: 10px; overflow: auto; }
        button { padding: 10px 20px; background: #80c157; color: white; border: none; cursor: pointer; }
        button:hover { background: #6aaa47; }
    </style>
</head>
<body>
    <h1>Upload Debug Test</h1>
    
    <div class="section">
        <h2>Test API Calls</h2>
        <button onclick="testGetUserUploads()">Test Get User Uploads (current user)</button>
        <button onclick="testGetUploads()">Test Get Uploads (browse page)</button>
        <button onclick="testDebugUploads()">Test Debug Uploads</button>
    </div>
    
    <div class="section">
        <h2>Results</h2>
        <div id="results">
            <p>Click a button above to test an API endpoint...</p>
        </div>
    </div>
    
    <script>
        function testGetUserUploads() {
            document.getElementById('results').innerHTML = '<p>Loading...</p>';
            const timestamp = Date.now();
            
            fetch('api/get-user-uploads.php?t=' + timestamp, {
                method: 'POST',
                credentials: 'same-origin',
                headers: {
                    'Cache-Control': 'no-cache, no-store, must-revalidate',
                    'Pragma': 'no-cache'
                }
            })
            .then(r => {
                console.log('Status:', r.status);
                return r.json();
            })
            .then(data => {
                console.log('Response:', data);
                document.getElementById('results').innerHTML = '<pre>' + JSON.stringify(data, null, 2) + '</pre>';
            })
            .catch(err => {
                console.error('Error:', err);
                document.getElementById('results').innerHTML = '<pre>ERROR: ' + err.message + '</pre>';
            });
        }
        
        function testGetUploads() {
            document.getElementById('results').innerHTML = '<p>Loading...</p>';
            const timestamp = Date.now();
            
            fetch('api/get-uploads.php?page=1&per_page=9&t=' + timestamp, {
                credentials: 'same-origin',
                headers: {
                    'Cache-Control': 'no-cache, no-store, must-revalidate',
                    'Pragma': 'no-cache'
                }
            })
            .then(r => {
                console.log('Status:', r.status);
                return r.json();
            })
            .then(data => {
                console.log('Response:', data);
                document.getElementById('results').innerHTML = '<pre>' + JSON.stringify(data, null, 2) + '</pre>';
            })
            .catch(err => {
                console.error('Error:', err);
                document.getElementById('results').innerHTML = '<pre>ERROR: ' + err.message + '</pre>';
            });
        }
        
        function testDebugUploads() {
            document.getElementById('results').innerHTML = '<p>Loading...</p>';
            
            fetch('api/debug-uploads.php', {
                credentials: 'same-origin'
            })
            .then(r => r.text())
            .then(data => {
                console.log('Response:', data);
                document.getElementById('results').innerHTML = '<pre>' + data + '</pre>';
            })
            .catch(err => {
                console.error('Error:', err);
                document.getElementById('results').innerHTML = '<pre>ERROR: ' + err.message + '</pre>';
            });
        }
    </script>
</body>
</html>

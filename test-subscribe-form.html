<!DOCTYPE html>
<html>
<head>
    <title>Subscribe Test</title>
    <style>
        body { font-family: Arial; padding: 20px; }
        .test-section { margin: 20px 0; padding: 10px; border: 1px solid #ccc; }
        .success { color: green; }
        .error { color: red; }
        pre { background: #f5f5f5; padding: 10px; overflow-x: auto; }
    </style>
</head>
<body>
    <h1>Newsletter Subscribe Test</h1>
    
    <div class="test-section">
        <h2>Test Form Submission</h2>
        <form id="mc-form" class="mc-form">
            <input type="email" name="EMAIL" id="mce-EMAIL" placeholder="Your Email Address" required>
            <input type="submit" value="Subscribe">
            <div class="mc-status"></div>
        </form>
    </div>

    <div class="test-section">
        <h2>Debug Output</h2>
        <div id="debug-output"></div>
    </div>

    <script>
        const debugLog = (msg) => {
            const output = document.getElementById('debug-output');
            const line = document.createElement('p');
            line.textContent = msg;
            output.appendChild(line);
            console.log(msg);
        };

        document.getElementById('mc-form').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const email = document.getElementById('mce-EMAIL').value.trim();
            const statusDiv = document.querySelector('.mc-status');
            
            debugLog(`1. Email entered: ${email}`);
            
            const formData = new FormData();
            formData.append('email', email);
            
            debugLog(`2. FormData created`);
            
            const pageUrl = window.location.href;
            debugLog(`3. Current page: ${pageUrl}`);
            
            // Try multiple API paths
            const apiPaths = [
                'api/subscribe-email.php',
                '/NoteShare/api/subscribe-email.php',
                window.location.origin + '/NoteShare/api/subscribe-email.php'
            ];
            
            debugLog(`4. Trying API paths:`);
            apiPaths.forEach(path => debugLog(`   - ${path}`));
            
            // Use the absolute path
            const apiUrl = window.location.origin + '/NoteShare/api/subscribe-email.php';
            debugLog(`5. Using absolute path: ${apiUrl}`);
            
            fetch(apiUrl, {
                method: 'POST',
                body: formData
            })
            .then(response => {
                debugLog(`6. Response status: ${response.status} ${response.statusText}`);
                return response.json();
            })
            .then(data => {
                debugLog(`7. Response data:`, JSON.stringify(data));
                statusDiv.innerHTML = data.success ? 
                    '✓ ' + data.message : 
                    '✗ ' + (data.message || 'Error');
                statusDiv.className = 'mc-status ' + (data.success ? 'success' : 'error');
            })
            .catch(error => {
                debugLog(`ERROR: ${error.message}`);
                statusDiv.innerHTML = '✗ Error: ' + error.message;
                statusDiv.className = 'mc-status error';
            });
        });
    </script>
</body>
</html>
